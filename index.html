<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exhibition Feedback Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            position: relative;
            overflow-x: hidden;
        }

        /* Remove .bg-animation and .particle styles */

        .container {
            max-width: 650px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-wrapper {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            padding: 50px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transform: translateY(20px);
            animation: slideUp 0.8s ease-out forwards;
            position: relative;
            overflow: hidden;
        }

        .form-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
            border-radius: 25px 25px 0 0;
        }

        @keyframes slideUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Logo Section */
        .logo-section {
            text-align: center;
            margin-bottom: 35px;
            position: relative;
        }

        .logo-container {
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            position: relative;
            cursor: pointer;
        }

        .logo-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            animation: logoFloat 6s ease-in-out infinite;
        }

        .logo-placeholder:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
        }

        .logo-placeholder i {
            font-size: 40px;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }

        .logo-text {
            color: #2d3748;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-subtitle {
            color: #718096;
            font-size: 15px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.4em;
            margin-bottom: 15px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #4a5568;
            font-size: 1.1em;
            line-height: 1.6;
            font-weight: 400;
        }

        .form-group {
            margin-bottom: 30px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            color: #2d3748;
            font-weight: 600;
            font-size: 0.95em;
            letter-spacing: 0.5px;
        }

        .form-control {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
        }

        .form-control::placeholder {
            color: #a0aec0;
            font-weight: 400;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 1);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 130px;
            font-family: 'Poppins', sans-serif;
        }

        .rating-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .rating-option input[type="radio"] {
            display: none;
        }

        .rating-option label {
            display: block;
            padding: 16px 12px;
            text-align: center;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.9em;
            background: rgba(255, 255, 255, 0.8);
            color: #4a5568;
        }

        .rating-option input[type="radio"]:checked + label {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .rating-option label:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .phone-input {
            position: relative;
        }

        .country-code {
            position: absolute;
            left: 24px;
            top: 50%;
            transform: translateY(-50%);
            color: #4a5568;
            font-weight: 600;
            z-index: 2;
            font-size: 16px;
        }

        .phone-input .form-control {
            padding-left: 70px;
        }

        .submit-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:active {
            transform: translateY(-2px);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .form-wrapper {
                padding: 35px 30px;
            }

            .logo-container {
                width: 80px;
                height: 80px;
            }

            .logo-placeholder i {
                font-size: 32px;
            }

            .logo-text {
                font-size: 24px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .rating-group {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .rating-option label {
                padding: 14px 10px;
                font-size: 0.85em;
            }

            .form-control {
                padding: 16px 20px;
            }

            .phone-input .form-control {
                padding-left: 65px;
            }
        }

        .success-message {
            display: none;
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            border-radius: 20px;
            margin-top: 25px;
            box-shadow: 0 15px 35px rgba(72, 187, 120, 0.3);
        }

        .success-message h3 {
            font-size: 24px;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .success-message p {
            font-size: 16px;
            font-weight: 400;
            line-height: 1.6;
        }

        .success-message.show {
            display: block;
            animation: fadeInScale 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Add some micro-interactions */
        .form-group {
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .form-group:hover {
            transform: translateY(-2px);
        }

        /* Enhanced focus states */
        .form-control:focus + .floating-label,
        .form-control:not(:placeholder-shown) + .floating-label {
            transform: translateY(-25px) scale(0.8);
            color: #667eea;
        }
    </style>
</head>
<body>
    <!-- tsParticles background -->
    <div id="tsparticles" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1;"></div>
    
    <div class="container">
        <div class="form-wrapper">
            <!-- Enhanced Logo Section -->
            <div class="logo-section">
                <div class="logo-container" style="display: flex; align-items: center; justify-content: center;">
                    <img src="logo.png" alt="School Logo" style="width: 319px; height: 121px; display: block; margin: 0 auto; object-fit: contain;" width="319" height="121">
                </div>
                <div class="logo-text">Bal Bharati Public School</div>
            </div>

            <div class="header">
                <h1>Exhibition Feedback</h1>
                <p>We'd love to hear your thoughts on our school exhibition! Your feedback helps us improve and create better experiences for everyone.</p>
            </div>

            <form id="feedbackForm">
                <div class="form-group">
                    <label for="name"><i class="fas fa-user" style="margin-right: 8px; color: #667eea;"></i>Your Name *</label>
                    <input type="text" id="name" name="name" class="form-control" placeholder="Enter your full name" required>
                </div>

                <div class="form-group">
                    <label for="email"><i class="fas fa-envelope" style="margin-right: 8px; color: #667eea;"></i>Email Address</label>
                    <input type="email" id="email" name="email" class="form-control" placeholder="your.email@example.com">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-star" style="margin-right: 8px; color: #667eea;"></i>Overall Experience *</label>
                    <div class="rating-group">
                        <div class="rating-option">
                            <input type="radio" id="excellent" name="rating" value="excellent" required>
                            <label for="excellent">üåü Excellent</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" id="good" name="rating" value="good">
                            <label for="good">üòä Good</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" id="average" name="rating" value="average">
                            <label for="average">üòê Average</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" id="poor" name="rating" value="poor">
                            <label for="poor">üòû Poor</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="favorite"><i class="fas fa-heart" style="margin-right: 8px; color: #667eea;"></i>What was your favorite part of the exhibition?</label>
                    <input type="text" id="favorite" name="favorite" class="form-control" placeholder="Science projects, art displays, performances, etc.">
                </div>

                <div class="form-group">
                    <label for="feedback"><i class="fas fa-comments" style="margin-right: 8px; color: #667eea;"></i>Additional Comments & Suggestions</label>
                    <textarea id="feedback" name="feedback" class="form-control" placeholder="Share your thoughts, suggestions for improvement, or anything else you'd like us to know..."></textarea>
                </div>

                <div class="form-group">
                    <label for="phone"><i class="fas fa-phone" style="margin-right: 8px; color: #667eea;"></i>Mobile Number (for updates about future events)</label>
                    <div class="phone-input">
                        <span class="country-code">+91</span>
                        <input type="tel" id="phone" name="phone" class="form-control" placeholder="9876543210" pattern="[0-9]{10}">
                    </div>
                </div>

                <button type="submit" class="submit-btn">
                    <i class="fas fa-paper-plane" style="margin-right: 10px;"></i>
                    Submit Feedback
                </button>
            </form>

            <div class="success-message" id="successMessage">
                <h3>üéâ Submitted!</h3>
                <p>Your feedback has been submitted successfully. We appreciate you taking the time to share your thoughts with us!</p>
                <button id="nextUserBtn" style="margin-top: 24px; padding: 12px 32px; background: #667eea; color: #fff; border: none; border-radius: 8px; font-size: 1.1em; font-family: 'Poppins', sans-serif; font-weight: 600; cursor: pointer; display: none;">Next</button>
            </div>
        </div>
    </div>

    <!-- Firebase App (the core Firebase SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <!-- Loading spinner style -->
    <script>
    const spinner = `<span class="spinner" style="display:inline-block;width:1.2em;height:1.2em;border:2.5px solid #fff;border-top:2.5px solid #667eea;border-radius:50%;animation:spin 0.7s linear infinite;vertical-align:middle;margin-right:10px;"></span>`;
    const style = document.createElement('style');
    style.innerHTML = `@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}`;
    document.head.appendChild(style);

    // Custom Canvas Particle Background
    const particleColors = ["#667eea", "#764ba2", "#f093fb", "#fff", "#ffd700"];
    const particleShapes = ["circle", "triangle", "star"];
    const PARTICLE_COUNT = 80;
    const particles = [];

    // Create and insert canvas
    const canvas = document.createElement('canvas');
    canvas.id = 'bg-particles';
    canvas.style.position = 'fixed';
    canvas.style.top = 0;
    canvas.style.left = 0;
    canvas.style.width = '100vw';
    canvas.style.height = '100vh';
    canvas.style.zIndex = -1;
    canvas.style.pointerEvents = 'none';
    document.body.prepend(canvas);

    let ctx = canvas.getContext('2d');
    let w = window.innerWidth;
    let h = window.innerHeight;
    function resizeCanvas() {
      w = window.innerWidth;
      h = window.innerHeight;
      canvas.width = w;
      canvas.height = h;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function randomBetween(a, b) { return a + Math.random() * (b - a); }

    function createParticle() {
      const shape = particleShapes[Math.floor(Math.random() * particleShapes.length)];
      return {
        x: Math.random() * w,
        y: Math.random() * h,
        r: randomBetween(8, 22),
        color: particleColors[Math.floor(Math.random() * particleColors.length)],
        shape,
        speed: randomBetween(0.2, 0.7),
        angle: Math.random() * Math.PI * 2,
        drift: randomBetween(-0.2, 0.2),
        opacity: randomBetween(0.18, 0.45),
        twinkle: Math.random() > 0.7
      };
    }
    for (let i = 0; i < PARTICLE_COUNT; i++) particles.push(createParticle());

    function drawStar(cx, cy, spikes, outerRadius, innerRadius, color, opacity) {
      let rot = Math.PI / 2 * 3;
      let x = cx;
      let y = cy;
      let step = Math.PI / spikes;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(cx, cy - outerRadius);
      for (let i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        ctx.lineTo(x, y);
        rot += step;
        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        ctx.lineTo(x, y);
        rot += step;
      }
      ctx.lineTo(cx, cy - outerRadius);
      ctx.closePath();
      ctx.globalAlpha = opacity;
      ctx.fillStyle = color;
      ctx.shadowColor = color;
      ctx.shadowBlur = 12;
      ctx.fill();
      ctx.restore();
    }

    function drawTriangle(x, y, r, color, opacity) {
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(x, y - r);
      ctx.lineTo(x - r * Math.sin(Math.PI / 3), y + r / 2);
      ctx.lineTo(x + r * Math.sin(Math.PI / 3), y + r / 2);
      ctx.closePath();
      ctx.globalAlpha = opacity;
      ctx.fillStyle = color;
      ctx.shadowColor = color;
      ctx.shadowBlur = 10;
      ctx.fill();
      ctx.restore();
    }

    function drawParticles() {
      ctx.clearRect(0, 0, w, h);
      for (let p of particles) {
        let op = p.opacity;
        if (p.twinkle && Math.random() > 0.85) op = Math.random();
        if (p.shape === "circle") {
          ctx.save();
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.globalAlpha = op;
          ctx.fillStyle = p.color;
          ctx.shadowColor = p.color;
          ctx.shadowBlur = 10;
          ctx.fill();
          ctx.restore();
        } else if (p.shape === "triangle") {
          drawTriangle(p.x, p.y, p.r, p.color, op);
        } else if (p.shape === "star") {
          drawStar(p.x, p.y, 5, p.r, p.r / 2.2, p.color, op);
        }
      }
    }

    function animateParticles() {
      for (let p of particles) {
        p.x += Math.cos(p.angle) * p.speed + p.drift;
        p.y += Math.sin(p.angle) * p.speed;
        p.angle += 0.002 * (Math.random() - 0.5);
        if (p.x < -40) p.x = w + 40;
        if (p.x > w + 40) p.x = -40;
        if (p.y < -40) p.y = h + 40;
        if (p.y > h + 40) p.y = -40;
      }
      drawParticles();
      requestAnimationFrame(animateParticles);
    }
    animateParticles();
    </script>

    <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDN5XNVZHGM2ZnQbFwtU5X_ZmpPMG7iuVw",
      authDomain: "formapp-fa5bf.firebaseapp.com",
      databaseURL: "https://formapp-fa5bf-default-rtdb.firebaseio.com",
      projectId: "formapp-fa5bf",
      storageBucket: "formapp-fa5bf.firebasestorage.app",
      messagingSenderId: "388421635704",
      appId: "1:388421635704:web:b2886874f514a9b8c2678d"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const feedbackForm = document.getElementById('feedbackForm');
    const submitBtn = feedbackForm.querySelector('.submit-btn');
    const successMessage = document.getElementById('successMessage');
    const nextUserBtn = document.getElementById('nextUserBtn');

    feedbackForm.addEventListener('submit', async function(e) {
      e.preventDefault();

      // If form is invalid, let browser show validation
      if (!feedbackForm.checkValidity()) {
        feedbackForm.reportValidity();
        return;
      }

      // Show loading state
      submitBtn.disabled = true;
      const originalBtnHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = spinner + 'Submitting...';

      const formData = new FormData(this);
      const data = Object.fromEntries(formData);

      // Save to Firebase
      let errorOccurred = false;
      try {
        await db.ref('feedbacks').push(data);
      } catch (err) {
        alert('Could not save feedback to database!');
        console.error(err);
        errorOccurred = true;
      }

      if (!errorOccurred) {
        try {
          const response = await fetch("https://sms-api-6pba.onrender.com/send-sms", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              phone: data.phone ? '91' + data.phone : '',
              name: data.name
            })
          });
          const result = await response.json();
          console.log("Proxy SMS API response:", result);

          if (result.return) {
            // show success UI only after successful submit
            feedbackForm.reset();
            feedbackForm.style.display = 'none';
            successMessage.classList.add('show');
            nextUserBtn.style.display = 'inline-block';
          } else {
            alert('SMS error: ' + result.message);
          }
        } catch (error) {
          console.error("SMS sending failed:", error);
          alert('Could not send SMS. Check console.');
        }
      }

      // Reset loading state
      submitBtn.disabled = false;
      submitBtn.innerHTML = originalBtnHTML;
    });

    // Next button logic
    if (nextUserBtn) {
      nextUserBtn.addEventListener('click', function() {
        feedbackForm.reset();
        feedbackForm.style.display = 'block';
        successMessage.classList.remove('show');
        nextUserBtn.style.display = 'none';
      });
    }
    </script>
      
</body>
</html>